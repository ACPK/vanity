<!DOCTYPE html>
<html>
  <head>
    <title>Vanity &mdash; Configuring the Playground</title>
    <link href="css/page.css" media="screen,print" rel="stylesheet" type="text/css">
    <link href="css/print.css" media="print" rel="stylesheet" type="text/css">
    <link href="images/favicon.png" rel="shortcut icon">
    <script type="text/javascript" src="https://ajax.googleapis.com/ajax/libs/jquery/1.3.2/jquery.min.js"></script>
    <script type="text/javascript" src="site.js"></script>
  </head>
  <body>
    <div id="header">
      <div class="title"><a href="http://vanity.labnotes.org" title="Mirror, mirror, on the wall &hellip;">Vanity</a></div>
      <div class="tagline">Experiment<br>Driven Development</div>
    </div>
    <div id="links">
      <a href="http://github.com/assaf/vanity">Source code</a> |
      <a href="http://stackoverflow.com/questions/tagged/vanity" title="stackoverflow vanity tag">StackOverflow Tag</a> |
      <a href="http://rdoc.info/gems/vanity">API reference</a>
    </div>
    <div id="sidebar">
      <ul>
        <li><a href="index.html#intro" title="A/B Testing with Rails">Intro</a></li>
        <li><a href="metrics.html">Metrics</a></li>
        <li><a href="ab_testing.html" title="Everything you need to know">A/B Testing</a></li>
        <li><a href="rails.html">Using with Rails</a></li>
        <li><a href="email.html">Testing emails</a></li>
        <li><a href="identity.html">Managing Identity</a></li>
        <li><a href="configuring.html">Configuring</a></li>
        <li><a href="contributing.html">Contributing</a></li>
        <li><a href="experimental.html">Experimental</a></li>
      </ul>
      <ul id="stats">
        <li><a href="http://travis-ci.org/assaf/vanity"><img src="https://api.travis-ci.org/assaf/vanity.png?branch=master"></a></li>
        <li><a href="http://wiki.github.com/assaf/vanity/whos-using-vanity">Who's using it?</a></li>
      </ul>
    </div>
    <div id="content">
      <h1 id="configuring the playground">Configuring the Playground</h1>
      <p>Vanity will work out of the box on a default configuration.  Assuming you&#8217;re using Redis on localhost, post 6379, there&#8217;s nothing special to do.</p>
<p>Database connection information is loaded from <code>config/vanity.yml</code>, based on the current environment (<code>RACK_ENV</code> or <code>RAILS_ENV</code>). Example:</p>
<pre>
development:
  adapter: redis
  connection: redis://localhost:6379/0
test:
  collecting: false
production:
  adapter: mongodb
  database: analytics
</pre>
<p>If there&#8217;s no configuration file and the application does not create a connection explicitly, Vanity will default to the Redis instance running on <code>localhost</code> at port 6379.</p>
<p>The available database adapters are:</p>
<ul>
	<li><ins>redis</ins> &#8212; This adapter is used by default. Available options are connection and password. host, port, database (defaults to 0) options are available, but deprecated.</li>
	<li><ins>mongodb</ins> &#8212; Available options are host, port, database (defaults to &#8220;vanity&#8221;), username and password.</li>
	<li><ins>active_record</ins> &#8212; Uses existing ActiveRecord configuration, by you can over-ride by supplying different options. To pick different underlying adapter, set <ins>active_record_adapter</ins>.</li>
</ul>
<h4>Configuration Options</h4>
<p>Available configuration options are:</p>
<table>
	<tr>
		<th>name                     </th>
		<th>Is all about &#8230;                    </th>
		<th>Default      </th>
	</tr>
	<tr>
		<td> add_participant_route      </td>
		<td> <span class="caps">URL</span> to use to add participants via JS </td>
		<td> /vanity/add_participant </td>
	</tr>
	<tr>
		<td> collecting                 </td>
		<td> False if you won&#8217;t want data collected</td>
		<td> true           </td>
	</tr>
	<tr>
		<td> config_file                </td>
		<td> File name to use to configure vanity  </td>
		<td> vanity.yml     </td>
	</tr>
	<tr>
		<td> config_path                </td>
		<td> Path to the config_file               </td>
		<td> ./config/      </td>
	</tr>
	<tr>
		<td> environment                </td>
		<td> What environment use for configuration</td>
		<td> development    </td>
	</tr>
	<tr>
		<td> experiments_path           </td>
		<td> Directory containing experiment files </td>
		<td> ./experiments  </td>
	</tr>
	<tr>
		<td> failover_on_datastore_error</td>
		<td> Whether to pass errors to on_datastore_error </td>
		<td> false   </td>
	</tr>
	<tr>
		<td> locales_path               </td>
		<td> Path to locales for translations      </td>
		<td> in the gem     </td>
	</tr>
	<tr>
		<td> logger                     </td>
		<td> This should be obvious                </td>
		<td> default/Rails  </td>
	</tr>
	<tr>
		<td> on_datastore_error         </td>
		<td> A proc that handles datastore errors  </td>
		<td> logs to logger </td>
	</tr>
	<tr>
		<td> request_filter             </td>
		<td> A proc that returns whether to to ignore the request for the add JS participant route </td>
		<td> Ignore requests with a HTTP_USER_AGENT that contain a <span class="caps">URL</span> </td>
	</tr>
	<tr>
		<td> templates_path             </td>
		<td> Path to templates for Vanity admin </td>
		<td> the templates in the gem </td>
	</tr>
	<tr>
		<td> use_js                     </td>
		<td> Whether to use JS to add particpants, useful to ignore bots </td>
		<td> false </td>
	</tr>
</table>
<p>When <a href="rails.html">running under Rails</a>, Vanity defaults to using the Rails logger, locates the load_path relative to Rails root, uses the <code>config/vanity.yml</code> configuration file (if present) and turns collection on only in production mode.</p>
<p>Use the playground object to configure Vanity. For example:</p>
<pre>
Vanity.configure do |config|
  config.use_js = true
  config.experiments_path = 'config/ab_tests'
  config.add_participant_route = '/vanity/participant/new'
  # ...
end
</pre>
<h4>Using metrics from Google Analytics</h4>
<p>If you want to use Vanity with metrics from Google Analytics, you must require the <code>garb</code> gem, and login for a new session.  You&#8217;ll want to do that for production, not for development if you like developing offline. For example in Rails, in the config/:</p>
<pre>
config.after_initialize do
  require "garb"
  Garb::Session.login('..ga email..', '..ga pwd..', account_type: "GOOGLE")
end
</pre>
    </div>
    <div id="footer"><a href="credits.html">Credits / License</a></div>
    <script type="text/javascript">var _gaq=_gaq||[];_gaq.push(["_setAccount", "UA-1828623-6"], ["_trackPageview"]);(function(){var ga=document.createElement("script");ga.src=("https:"==document.location.protocol?"https://ssl":"http://www")+".google-analytics.com/ga.js";ga.setAttribute("async", "true");document.documentElement.firstChild.appendChild(ga);})();</script>
  </body>
</html>
